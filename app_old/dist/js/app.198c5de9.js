(function(){"use strict";var t={6895:function(t,e,a){var s=a(9242),i=a(3396);function n(t,e,a,s,n,r){const o=(0,i.up)("router-view");return(0,i.wg)(),(0,i.j4)(o)}var r={name:"HomeView",data(){return{appAuth:{},tasksList:{},projectsId:[]}}},o=a(89);const l=(0,o.Z)(r,[["render",n]]);var c=l,u=a(2483);const d={class:"tasks__popup"},p=(0,i._)("div",{class:"tasks__popup-detail"},[(0,i._)("div",{class:"tasks__popup-header"},[(0,i._)("h3",{class:"tasks__popup-header-title"},"Task Detail")])],-1),h=[p];function m(t,e,a,s,n,r){return(0,i.wg)(),(0,i.iD)("div",d,h)}var g={name:"Item"};const f=(0,o.Z)(g,[["render",m]]);var v=f;const k={class:"main-grid"},b={class:"main-grid-container"};function _(t,e,a,s,n,r){const o=(0,i.up)("GridHead"),l=(0,i.up)("GridBody");return(0,i.wg)(),(0,i.iD)("div",k,[(0,i._)("div",b,[(0,i.Wm)(o),(0,i.Wm)(l,{tasksObj:n.tasksList},null,8,["tasksObj"])])])}var O=a(65),w=a(7139);const y={class:"main-grid-header"},D={class:"main-grid-row-head"},j={class:"main-grid-cell-inner"},S={class:"main-grid-cell-head-container"},A={class:"main-grid-head-title"},P=(0,i._)("span",{class:"main-grid-resize-button",title:"{{title}}"},null,-1),N=(0,i._)("span",{class:"main-grid-control-sortmain-grid-control-sort-desc"},null,-1);function J(t,e,a,s,n,r){return(0,i.wg)(),(0,i.iD)("div",y,[(0,i._)("div",D,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.headerTitles,(t=>((0,i.wg)(),(0,i.iD)("div",{class:(0,w.C_)(["main-grid-cell-head main-grid-cell-left",t])},[(0,i._)("div",j,[(0,i._)("span",S,[(0,i._)("span",A,(0,w.zw)(t),1),P,N])])],2)))),256))])])}var T={name:"GridHead",data(){return{headerTitles:["Название","Активность","Крайний срок","Постановщик","Ответственный","Проект"]}},methods:{},computed:{},created(){},watch:{}};const x=(0,o.Z)(T,[["render",J]]);var G=x,I=a.p+"img/loader.87bd8715.gif";const L={class:"main-grid-body"},C={class:"main-grid-row main-grid-row-body"},H={class:"main-grid-cell-inner"},M={class:"main-grid-cell-content"},z={key:0,class:"main-grid-loader"},U=(0,i._)("img",{class:"main-grid-loader-gif",alt:"loader.gif",src:I},null,-1),Z=[U];function $(t,e,a,s,n,r){const o=(0,i.up)("router-link");return(0,i.wg)(),(0,i.iD)("div",L,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.tasksList,(t=>((0,i.wg)(),(0,i.iD)("div",C,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t,(t=>((0,i.wg)(),(0,i.iD)("div",{class:(0,w.C_)(["main-grid-cell",t.name])},[(0,i._)("div",H,[(0,i._)("span",M,["title"!=t.name?((0,i.wg)(),(0,i.iD)("a",{key:0,class:(0,w.C_)(["main-grid-cell-task",{"ui-label ui-label-default ui-label-fill ui-label-link":"deadline"===t.name}])},(0,w.zw)(t.value.name?t.value.name:t.value),3)):(0,i.kq)("",!0),"title"==t.name?((0,i.wg)(),(0,i.j4)(o,{key:1,class:(0,w.C_)(["main-grid-cell-task",{"ui-label ui-label-default ui-label-fill ui-label-link":"deadline"===t.name}]),to:"/item/"+t.value.id},{default:(0,i.w5)((()=>[(0,i.Uk)((0,w.zw)(t.value.title),1)])),_:2},1032,["to","class"])):(0,i.kq)("",!0)])])],2)))),256))])))),256)),n.loader?((0,i.wg)(),(0,i.iD)("div",z,Z)):(0,i.kq)("",!0)])}a(7658);var q={name:"GridBody",props:{tasksObj:{type:Object,required:!0}},data(){return{appAuth:{},tasksList:{},loader:!1}},methods:{},computed:{},created(){},watch:{tasksObj:{immediate:!0,handler(t,e){if(Object.keys(t).length>0){let s=["title","activityDate","deadline","creator","responsible","group"];var a=[];function i(t){const e={year:"numeric",month:"long",day:"numeric"},a=new Date(t).toLocaleDateString(void 0,e);return a}for(let n=0;n<this.tasksObj.length;n++){let r=0;a.push(s.map((t=>(r++,"activityDate"==t||"deadline"==t?(this.tasksObj[n][t]=null==this.tasksObj[n][t]?"Без срока":i(this.tasksObj[n][t]),{id:r,name:t,value:this.tasksObj[n][t]}):"title"==t?(console.log(this.tasksObj[n]),{id:r,name:t,value:{id:this.tasksObj[n]["id"],title:this.tasksObj[n]["title"]}}):{id:r,name:t,value:this.tasksObj[n][t]}))))}this.tasksList=a,this.loader=!1}else 0==Object.keys(t).length&&(this.loader=!0)}}}};const B=(0,o.Z)(q,[["render",$]]);var K=B;async function E(t,e,a,s){var i=new Headers;i.append("Content-Type","application/json");var n=JSON.stringify(a),r={method:"POST",headers:i,body:n,redirect:"follow"};return fetch(`https://${t}/rest/${e}?auth=${s}`,r).then((t=>t.text())).then((t=>t)).catch((t=>console.log("error",t)))}var Y={name:"Grid",data(){return{appAuth:{},tasksList:{},projectsId:[]}},components:{GridHead:G,GridBody:K},methods:{},computed:{...(0,O.Se)(["getUserData"]),...(0,O.Se)(["getAppData"])},async created(){await this.$store.dispatch("getAuthPortal"),await this.$store.dispatch("getAuth"),this.projectsId=[this.getUserData.projectsID]},watch:{projectsId:{immediate:!0,async handler(t,e){if(sessionStorage.tasks_list)this.tasksList=JSON.parse(sessionStorage.tasks_list),console.log("из сессии");else if(t.length>0){this.appAuth=this.getAppData;let t=this.projectsId,e={filter:{GROUP_ID:t[0]}};var a=await E("cp.micros.uz","tasks.task.list",e,this.appAuth.access_token);JSON.parse(a)&&(sessionStorage.tasks_list=JSON.stringify(JSON.parse(a).result.tasks),this.tasksList=JSON.parse(a).result.tasks,console.log("из rest запроса"))}}}}};const W=(0,o.Z)(Y,[["render",_]]);var F=W;const R=(0,u.p7)({history:(0,u.PO)(),routes:[{path:"/",name:"Grid",component:F},{path:"/item/:id",name:"Item",component:v}]});var V=R,X=(0,O.MT)({state:{userData:{},techPortal:{}},getters:{getUserData(t){return t.userData},getAppData(t){return t.techPortal}},mutations:{userDataMutation(t,e){return t.userData=e},appDataMutation(t,e){return t.techPortal=e}},actions:{async getAuth({commit:t}){if(sessionStorage.client_token)t("userDataMutation",JSON.parse(sessionStorage.client_token));else;},async getAuthPortal({commit:t}){if(!sessionStorage.tech_token){var e={method:"POST",redirect:"follow"};return fetch("https://micros.uz/it/solutions_our/micros.tech.support/ajax.php?APP_TOKEN=true",e).then((t=>t.text())).then((e=>{sessionStorage.tech_token=e,t("appDataMutation",JSON.parse(e))})).catch((t=>console.log("error",t)))}t("appDataMutation",JSON.parse(sessionStorage.tech_token))}},modules:{}});{const t=document.createElement("script");t.src="//api.bitrix24.com/api/v1/";document.head.appendChild(t);t.onload=function(){sessionStorage.client_token||BX24.callMethod("app.option.get",{},(t=>{sessionStorage.client_token=JSON.stringify(t.data())}))}}(0,s.ri)(c).use(X).use(V).mount("#app")}},e={};function a(s){var i=e[s];if(void 0!==i)return i.exports;var n=e[s]={exports:{}};return t[s].call(n.exports,n,n.exports,a),n.exports}a.m=t,function(){var t=[];a.O=function(e,s,i,n){if(!s){var r=1/0;for(u=0;u<t.length;u++){s=t[u][0],i=t[u][1],n=t[u][2];for(var o=!0,l=0;l<s.length;l++)(!1&n||r>=n)&&Object.keys(a.O).every((function(t){return a.O[t](s[l])}))?s.splice(l--,1):(o=!1,n<r&&(r=n));if(o){t.splice(u--,1);var c=i();void 0!==c&&(e=c)}}return e}n=n||0;for(var u=t.length;u>0&&t[u-1][2]>n;u--)t[u]=t[u-1];t[u]=[s,i,n]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var s in e)a.o(e,s)&&!a.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.p="/micros.support/"}(),function(){var t={143:0};a.O.j=function(e){return 0===t[e]};var e=function(e,s){var i,n,r=s[0],o=s[1],l=s[2],c=0;if(r.some((function(e){return 0!==t[e]}))){for(i in o)a.o(o,i)&&(a.m[i]=o[i]);if(l)var u=l(a)}for(e&&e(s);c<r.length;c++)n=r[c],a.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return a.O(u)},s=self["webpackChunkmicros_support"]=self["webpackChunkmicros_support"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(6895)}));s=a.O(s)})();
//# sourceMappingURL=app.198c5de9.js.map