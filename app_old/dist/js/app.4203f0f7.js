(function(){"use strict";var t={3038:function(t,e,a){var s=a(9242),i=a(3396);function r(t,e,a,s,r,n){const o=(0,i.up)("Main");return(0,i.wg)(),(0,i.j4)(o)}function n(t,e,a,s,r,n){const o=(0,i.up)("router-view");return(0,i.wg)(),(0,i.j4)(o)}var o={name:"HomeView",data(){return{appAuth:{},tasksList:{},projectsId:[]}},components:{Main:u}},l=a(89);const c=(0,l.Z)(o,[["render",n]]);var u=c,d={name:"HomeView",data(){return{appAuth:{},tasksList:{},projectsId:[]}},components:{Main:u}};const p=(0,l.Z)(d,[["render",r]]);var h=p,m=a(2483),g=a(7139);const f={class:"tasks__popup"},k={class:"tasks__popup-detail"},v={class:"tasks__popup-header"},_={class:"tasks__popup-header-title"};function w(t,e,a,s,r,n){return(0,i.wg)(),(0,i.iD)("div",f,[(0,i._)("div",k,[(0,i._)("div",v,[(0,i._)("h3",_,"Task Detail "+(0,g.zw)(t.$route.params.id),1),(0,i._)("pre",null,(0,g.zw)(r.taskObject),1)])])])}var b=a(65);async function O(t,e,a,s){var i=new Headers;i.append("Content-Type","application/json");var r=JSON.stringify(a),n={method:"POST",headers:i,body:r,redirect:"follow"};return fetch(`https://${t}/rest/${e}?auth=${s}`,n).then((t=>t.text())).then((t=>t)).catch((t=>console.log("error",t)))}var j={name:"Item",data(){return{appAuth:{},tasksList:{},loader:!1,taskObject:""}},methods:{},computed:{...(0,b.Se)(["getUserData"]),...(0,b.Se)(["getAppData"])},async created(){await this.$store.dispatch("getAuthPortal"),await this.$store.dispatch("getAuth");let t={taskId:this.$route.params.id};this.taskObject=await O("cp.micros.uz","tasks.task.get",t,this.getAppData.access_token),console.log(this.taskObject)},watch:{}};const D=(0,l.Z)(j,[["render",w]]);var y=D;const S={class:"main-grid"},A={class:"main-grid-container"};function P(t,e,a,s,r,n){const o=(0,i.up)("GridHead"),l=(0,i.up)("GridBody");return(0,i.wg)(),(0,i.iD)("div",S,[(0,i._)("div",A,[(0,i.Wm)(o),(0,i.Wm)(l,{tasksObj:r.tasksList},null,8,["tasksObj"])])])}const N={class:"main-grid-header"},L={class:"main-grid-row-head"},I={class:"main-grid-cell-inner"},M={class:"main-grid-cell-head-container"},J={class:"main-grid-head-title"},T=(0,i._)("span",{class:"main-grid-resize-button",title:"{{title}}"},null,-1),x=(0,i._)("span",{class:"main-grid-control-sortmain-grid-control-sort-desc"},null,-1);function z(t,e,a,s,r,n){return(0,i.wg)(),(0,i.iD)("div",N,[(0,i._)("div",L,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(r.headerTitles,(t=>((0,i.wg)(),(0,i.iD)("div",{class:(0,g.C_)(["main-grid-cell-head main-grid-cell-left",t])},[(0,i._)("div",I,[(0,i._)("span",M,[(0,i._)("span",J,(0,g.zw)(t),1),T,x])])],2)))),256))])])}var G={name:"GridHead",data(){return{headerTitles:["Название","Активность","Крайний срок","Постановщик","Ответственный","Проект"]}},methods:{},computed:{},created(){},watch:{}};const H=(0,l.Z)(G,[["render",z]]);var $=H,C=a.p+"img/loader.87bd8715.gif";const U={class:"main-grid-body"},E={class:"main-grid-row main-grid-row-body"},Z={class:"main-grid-cell-inner"},B={class:"main-grid-cell-content"},q={key:0,class:"main-grid-loader"},K=(0,i._)("img",{class:"main-grid-loader-gif",alt:"loader.gif",src:C},null,-1),V=[K];function Y(t,e,a,s,r,n){const o=(0,i.up)("router-link");return(0,i.wg)(),(0,i.iD)("div",U,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(r.tasksList,(t=>((0,i.wg)(),(0,i.iD)("div",E,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t,(t=>((0,i.wg)(),(0,i.iD)("div",{class:(0,g.C_)(["main-grid-cell",t.name])},[(0,i._)("div",Z,[(0,i._)("span",B,["title"!=t.name?((0,i.wg)(),(0,i.iD)("a",{key:0,class:(0,g.C_)(["main-grid-cell-task",{"ui-label ui-label-default ui-label-fill ui-label-link":"deadline"===t.name}])},(0,g.zw)(t.value.name?t.value.name:t.value),3)):(0,i.kq)("",!0),"title"==t.name?((0,i.wg)(),(0,i.j4)(o,{key:1,class:(0,g.C_)(["main-grid-cell-task",{"ui-label ui-label-default ui-label-fill ui-label-link":"deadline"===t.name}]),to:"/item/"+t.value.id},{default:(0,i.w5)((()=>[(0,i.Uk)((0,g.zw)(t.value.title),1)])),_:2},1032,["to","class"])):(0,i.kq)("",!0)])])],2)))),256))])))),256)),r.loader?((0,i.wg)(),(0,i.iD)("div",q,V)):(0,i.kq)("",!0)])}a(7658);var R={name:"GridBody",props:{tasksObj:{type:Object,required:!0}},data(){return{appAuth:{},tasksList:{},loader:!1}},methods:{},computed:{},created(){},watch:{tasksObj:{immediate:!0,handler(t,e){if(Object.keys(t).length>0){let s=["title","activityDate","deadline","creator","responsible","group"];var a=[];function i(t){const e={year:"numeric",month:"long",day:"numeric"},a=new Date(t).toLocaleDateString(void 0,e);return a}for(let r=0;r<this.tasksObj.length;r++){let n=0;a.push(s.map((t=>(n++,"activityDate"==t||"deadline"==t?(this.tasksObj[r][t]=null==this.tasksObj[r][t]?"Без срока":i(this.tasksObj[r][t]),{id:n,name:t,value:this.tasksObj[r][t]}):"title"==t?{id:n,name:t,value:{id:this.tasksObj[r]["id"],title:this.tasksObj[r]["title"]}}:{id:n,name:t,value:this.tasksObj[r][t]}))))}this.tasksList=a,this.loader=!1}else 0==Object.keys(t).length&&(this.loader=!0)}}}};const W=(0,l.Z)(R,[["render",Y]]);var F=W;console.log({NODE_ENV:"production",BASE_URL:"/it/solutions_our/micros.tech.support/app/dist/"});var X={name:"Grid",data(){return{appAuth:{},tasksList:{},projectsId:[]}},components:{GridHead:$,GridBody:F},methods:{},computed:{...(0,b.Se)(["getUserData"]),...(0,b.Se)(["getAppData"])},async created(){await this.$store.dispatch("getAuthPortal"),await this.$store.dispatch("getAuth"),this.projectsId=[this.getUserData.projectsID]},watch:{projectsId:{immediate:!0,async handler(t,e){if(sessionStorage.tasks_list)this.tasksList=JSON.parse(sessionStorage.tasks_list),console.log("из сессии");else if(t.length>0){this.appAuth=this.getAppData;let t=this.projectsId,e={filter:{GROUP_ID:t[0]}};var a=await O("cp.micros.uz","tasks.task.list",e,this.appAuth.access_token);JSON.parse(a)&&(sessionStorage.tasks_list=JSON.stringify(JSON.parse(a).result.tasks),this.tasksList=JSON.parse(a).result.tasks,console.log("из rest запроса"))}}}}};const Q=(0,l.Z)(X,[["render",P]]);var tt=Q;const et=(0,m.p7)({history:(0,m.PO)(),routes:[{path:"/",name:"Grid",component:tt},{path:"/item/:id",name:"Item",component:y}]});var at=et,st=(0,b.MT)({state:{userData:{},techPortal:{}},getters:{getUserData(t){return t.userData},getAppData(t){return t.techPortal}},mutations:{userDataMutation(t,e){return t.userData=e},appDataMutation(t,e){return t.techPortal=e}},actions:{async getAuth({commit:t}){if(sessionStorage.client_token)t("userDataMutation",JSON.parse(sessionStorage.client_token));else;},async getAuthPortal({commit:t}){if(!sessionStorage.tech_token){var e={method:"POST",redirect:"follow"};return fetch("https://micros.uz/it/solutions_our/micros.tech.support/ajax.php?APP_TOKEN=true",e).then((t=>t.text())).then((e=>{sessionStorage.tech_token=e,t("appDataMutation",JSON.parse(e))})).catch((t=>console.log("error",t)))}t("appDataMutation",JSON.parse(sessionStorage.tech_token))}},modules:{}});{const t=document.createElement("script");t.src="//api.bitrix24.com/api/v1/";document.head.appendChild(t);t.onload=function(){sessionStorage.client_token||BX24.callMethod("app.option.get",{},(t=>{sessionStorage.client_token=JSON.stringify(t.data())}))}}(0,s.ri)(h).use(st).use(at).mount("#app")}},e={};function a(s){var i=e[s];if(void 0!==i)return i.exports;var r=e[s]={exports:{}};return t[s].call(r.exports,r,r.exports,a),r.exports}a.m=t,function(){var t=[];a.O=function(e,s,i,r){if(!s){var n=1/0;for(u=0;u<t.length;u++){s=t[u][0],i=t[u][1],r=t[u][2];for(var o=!0,l=0;l<s.length;l++)(!1&r||n>=r)&&Object.keys(a.O).every((function(t){return a.O[t](s[l])}))?s.splice(l--,1):(o=!1,r<n&&(n=r));if(o){t.splice(u--,1);var c=i();void 0!==c&&(e=c)}}return e}r=r||0;for(var u=t.length;u>0&&t[u-1][2]>r;u--)t[u]=t[u-1];t[u]=[s,i,r]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var s in e)a.o(e,s)&&!a.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.p="/it/solutions_our/micros.tech.support/app/dist/"}(),function(){var t={143:0};a.O.j=function(e){return 0===t[e]};var e=function(e,s){var i,r,n=s[0],o=s[1],l=s[2],c=0;if(n.some((function(e){return 0!==t[e]}))){for(i in o)a.o(o,i)&&(a.m[i]=o[i]);if(l)var u=l(a)}for(e&&e(s);c<n.length;c++)r=n[c],a.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return a.O(u)},s=self["webpackChunkmicros_support"]=self["webpackChunkmicros_support"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(3038)}));s=a.O(s)})();
//# sourceMappingURL=app.4203f0f7.js.map